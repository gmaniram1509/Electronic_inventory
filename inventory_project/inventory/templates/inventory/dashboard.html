{% extends 'inventory/base.html' %}

{% block title %}Dashboard - Electronic Inventory{% endblock %}

{% block content %}
<div class="container">
    <div class="dashboard-header">
        <h2>Inventory Dashboard</h2>
        <div class="stats-container">
            <div class="stat-card">
                <h3>Total Products</h3>
                <p class="stat-number">{{ products.count }}</p>
            </div>
            <div class="stat-card">
                <h3>Total Categories</h3>
                <p class="stat-number">{{ categories.count }}</p>
            </div>
            <div class="stat-card alert-card">
                <h3>Low Stock Items</h3>
                <p class="stat-number">{{ low_stock_products.count }}</p>
            </div>
            <div class="stat-card">
                <h3>Recent Transactions</h3>
                <p class="stat-number">{{ recent_transactions.count }}</p>
            </div>
        </div>
    </div>

    {% if low_stock_products %}
    <div class="section">
        <h3 class="section-title">Low Stock Alerts</h3>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Product</th>
                        <th>SKU</th>
                        <th>Category</th>
                        <th>Current Stock</th>
                        <th>Min Level</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for product in low_stock_products %}
                    <tr>
                        <td>{{ product.name }}</td>
                        <td>{{ product.sku }}</td>
                        <td>{{ product.category }}</td>
                        <td>{{ product.quantity }}</td>
                        <td>{{ product.min_stock_level }}</td>
                        <td><span class="badge badge-warning">Low Stock</span></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% endif %}

    <div class="section">
        <h3 class="section-title">All Products</h3>
        <div class="table-container">
            {% if products %}
            <table>
                <thead>
                    <tr>
                        <th>Product Name</th>
                        <th>SKU</th>
                        <th>Category</th>
                        <th>Quantity</th>
                        <th>Unit Price</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for product in products %}
                    <tr>
                        <td>{{ product.name }}</td>
                        <td>{{ product.sku }}</td>
                        <td>{{ product.category }}</td>
                        <td>{{ product.quantity }}</td>
                        <td>${{ product.unit_price }}</td>
                        <td>
                            {% if product.is_low_stock %}
                            <span class="badge badge-warning">Low Stock</span>
                            {% else %}
                            <span class="badge badge-success">In Stock</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p class="no-data">No products found. Add products via the <a href="/admin/">Admin Panel</a>.</p>
            {% endif %}
        </div>
    </div>

    <div class="section">
        <h3 class="section-title">Recent Transactions</h3>
        <div class="table-container">
            {% if recent_transactions %}
            <table>
                <thead>
                    <tr>
                        <th>Product</th>
                        <th>Type</th>
                        <th>Quantity</th>
                        <th>User</th>
                        <th>Date</th>
                    </tr>
                </thead>
                <tbody>
                    {% for transaction in recent_transactions %}
                    <tr>
                        <td>{{ transaction.product.name }}</td>
                        <td>
                            {% if transaction.transaction_type == 'IN' %}
                            <span class="badge badge-success">Stock In</span>
                            {% else %}
                            <span class="badge badge-info">Stock Out</span>
                            {% endif %}
                        </td>
                        <td>{{ transaction.quantity }}</td>
                        <td>{{ transaction.user|default:"N/A" }}</td>
                        <td>{{ transaction.created_at|date:"M d, Y H:i" }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p class="no-data">No transactions recorded yet.</p>
            {% endif %}
        </div>
    </div>

    <div class="quick-actions">
        <h3 class="section-title">Quick Actions</h3>
        <div class="action-buttons">
            <a href="/admin/inventory/product/add/" class="btn btn-primary">Add Product</a>
            <a href="/admin/inventory/category/add/" class="btn btn-secondary">Add Category</a>
            <a href="/admin/inventory/transaction/add/" class="btn btn-info">Record Transaction</a>
            <a href="/admin/inventory/" class="btn btn-success">Manage All</a>
        </div>
    </div>
</div>
{% endblock %}
